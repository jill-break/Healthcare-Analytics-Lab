Healthcare Analytics Lab: Star Schema Performance Analysis
Database: olap_healthtech
Dataset Size: ~10,000 rows (Test Subset)


QUERY 1: Monthly Encounters by Specialty

SQL Query:
SELECT 
    d.year, d.month_name, s.specialty_name, et.encounter_type_name,
    COUNT(f.encounter_key) AS total_encounters,
    COUNT(DISTINCT f.patient_key) AS unique_patients
FROM olap_healthtech.fact_encounters f
JOIN olap_healthtech.dim_date d ON f.date_key = d.date_key
JOIN olap_healthtech.dim_specialty s ON f.specialty_key = s.specialty_key
JOIN olap_healthtech.dim_encounter_type et ON f.encounter_type_key = et.encounter_type_key
GROUP BY d.year, d.month, d.month_name, s.specialty_name, et.encounter_type_name
ORDER BY d.year DESC, d.month DESC, s.specialty_name;

Performance Comparison:
- OLTP Time: 0.046s
- OLAP Time: 0.141s 
- Result: Slower

Analysis:
On this small dataset (10k rows), the Star Schema was slower. This is due to the "Small Data Overhead." The database engine found it faster to scan the single flat OLTP table than to perform the 4-way join required by the Star Schema. The benefits of the Star Schema would only become visible at scale (millions of rows).



QUERY 2: Top Diagnosis-Procedure Pairs

SQL Query:
SELECT 
    dd.icd10_code, dp.cpt_code,
    COUNT(f.encounter_key) AS combo_count
FROM olap_healthtech.fact_encounters f
JOIN olap_healthtech.bridge_encounter_diagnoses bd ON f.encounter_key = bd.encounter_key
JOIN olap_healthtech.dim_diagnoses dd ON bd.diagnosis_key = dd.diagnosis_key
JOIN olap_healthtech.bridge_encounter_procedures bp ON f.encounter_key = bp.encounter_key
JOIN olap_healthtech.dim_procedures dp ON bp.procedure_key = dp.procedure_key
GROUP BY dd.icd10_code, dp.cpt_code
ORDER BY combo_count DESC
LIMIT 10;

Performance Comparison:
- OLTP Time: 0.094s
- OLAP Time: 0.219s 
- Result: Slower

Analysis:
The Star Schema was slower here because of the Bridge Tables. Joining the Fact table to two separate bridge tables created the same "Row Explosion" (Cartesian product) as the OLTP system. This proves that Many-to-Many relationships remain expensive in any schema unless a specific "Snapshot" table is created to pre-aggregate these pairs.



QUERY 3: 30-Day Readmission Rate (The "Killer Feature")

SQL Query:
SELECT 
    s.specialty_name,
    COUNT(f.encounter_key) AS total_discharges,
    SUM(f.is_readmission) AS readmissions,
    (SUM(f.is_readmission) / COUNT(f.encounter_key)) * 100 AS readmission_rate
FROM olap_healthtech.fact_encounters f
JOIN olap_healthtech.dim_specialty s ON f.specialty_key = s.specialty_key
JOIN olap_healthtech.dim_encounter_type et ON f.encounter_type_key = et.encounter_type_key
WHERE et.encounter_type_name = 'Inpatient'
GROUP BY s.specialty_name
ORDER BY readmission_rate DESC;

Performance Comparison:
- OLTP Time: 0.047s (with 8 temporary tables!)
- OLAP Time: 0.016s 
- Result: 300% Faster (3x Speedup)

Analysis:
This is the massive win. In OLTP, calculating readmissions required a complex Self-Join that scanned the table recursively, creating 8 temporary tables. In the Star Schema, we moved this logic to the ETL phase. The query now simply sums the pre-calculated 'is_readmission' flag (0 or 1). It reduced the 'Rows Examined' from ~26,000 to ~6,000.



QUERY 4: Revenue by Specialty & Month

SQL Query:
SELECT 
    s.specialty_name,
    CONCAT(d.year, '-', LPAD(d.month, 2, '0')) AS billing_month,
    SUM(f.total_allowed_amount) AS total_revenue
FROM olap_healthtech.fact_encounters f
JOIN olap_healthtech.dim_date d ON f.date_key = d.date_key
JOIN olap_healthtech.dim_specialty s ON f.specialty_key = s.specialty_key
GROUP BY s.specialty_name, d.year, d.month
ORDER BY total_revenue DESC;

Performance Comparison:
- OLTP Time: 0.125s
- OLAP Time: 0.063s 
- Result: 200% Faster (2x Speedup)

Analysis:
I achieved a 2x speedup by Denormalization. In the OLTP system, revenue data lived 
in a separate 'billing' table, forcing a massive join between Encounters and Billing. 
In the Star Schema, I moved 'total_allowed_amount' directly into the 'fact_encounters' table. 
This allowed me to calculate revenue without touching the billing table at all.